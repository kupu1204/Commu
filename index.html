<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>수학 커뮤니티 사이트</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header class="top-nav">
  <div class="brand">
    <span class="brand-title">Math Community</span>
  </div>
  <div class="user-area">
    <span id="welcome-text" class="welcome"></span>
    <button id="logout-btn" class="btn small-btn hidden">로그아웃</button>
  </div>
</header>

<main class="main-container">

  <!-- 로그인 / 회원가입 화면 -->
  <section id="login-screen" class="card">
    <h1>로그인 / 회원가입</h1>
    <p class="text-muted">아이디와 비밀번호로 로그인하고, 글과 댓글을 남길 수 있습니다.</p>

    <div class="auth-tabs">
      <button type="button" class="auth-tab-btn active" data-target="login">로그인</button>
      <button type="button" class="auth-tab-btn" data-target="register">회원가입</button>
    </div>

    <!-- 로그인 폼 -->
    <form id="login-form" class="auth-form">
      <label>아이디</label>
      <input type="text" id="login-username" required>
      <label>비밀번호</label>
      <input type="password" id="login-password" required>
      <button type="submit" class="btn primary-btn full">로그인</button>
    </form>

    <!-- 회원가입 폼 -->
    <form id="register-form" class="auth-form hidden">
      <label>아이디</label>
      <input type="text" id="register-username" required>
      <label>비밀번호</label>
      <input type="password" id="register-password" required>
      <button type="submit" class="btn primary-btn full">회원가입</button>
    </form>
  </section>

  <!-- 메인 커뮤니티 화면 -->
  <section id="main-screen" class="hidden">
    <!-- 새 글 작성 -->
    <section class="card">
      <h2>새 글 작성</h2>
      <form id="new-post-form" class="post-form">
        <input type="text" id="post-title" placeholder="제목" required>
        <textarea id="post-content" rows="3" placeholder="내용" required></textarea>

        <!-- 그래프 사용 여부 + 식 입력 -->
        <div class="graph-toggle-row">
          <label class="graph-toggle">
            <input type="checkbox" id="post-graph-enable">
            이 글에 그래프 붙이기
          </label>
          <input
            type="text"
            id="post-graph-input"
            class="hidden"
            placeholder="그래프 식 (예: x^2 + 2x + 1, 1/x)"
          >
        </div>

        <div class="right">
          <button type="submit" class="btn primary-btn">작성</button>
        </div>
      </form>
    </section>

    <!-- 글 목록 -->
    <section class="card">
      <h2>글 목록</h2>
      <div id="posts-list" class="post-list">
        <!-- JS로 글 카드가 들어감 -->
      </div>
    </section>
  </section>

  <!-- 글 상세 + 댓글 모달 -->
  <div id="detail-modal" class="modal hidden">
    <div class="modal-content">
      <button id="detail-close-btn" class="modal-close">&times;</button>

      <section class="card">
        <div class="post-detail-header">
          <h2 id="detail-title"></h2>
          <div class="meta" id="detail-meta"></div>
        </div>

        <div class="post-detail-body">
          <p id="detail-content"></p>
        </div>

        <!-- 글에 그래프 식이 있을 때만 JS에서 보여줌 -->
        <div id="post-graph-container" class="post-graph hidden">
          <div class="post-graph-label">
            y = <span id="post-graph-expr"></span>
          </div>
          <canvas id="post-graph-canvas" width="260" height="160"></canvas>
        </div>

        <div class="post-detail-footer">
          <form id="detail-like-form" class="inline-form">
            <button type="submit" data-type="like" class="btn small-btn">
              👍 <span id="detail-like-count">0</span>
            </button>
            <button type="submit" data-type="dislike" class="btn small-btn">
              👎 <span id="detail-dislike-count">0</span>
            </button>
          </form>
        </div>

        <!-- 작성자만 보이는 글 수정/삭제 버튼 -->
        <div id="detail-owner-actions" class="post-detail-actions hidden">
          <button id="detail-edit-btn" class="btn small-btn">글 수정</button>
          <button id="detail-delete-btn" class="btn small-btn danger-btn">글 삭제</button>
        </div>
      </section>

      <section class="card">
        <h3>댓글</h3>
        <div id="comments-list" class="comment-list"></div>

        <form id="comment-form" class="comment-form">
          <textarea
            id="comment-input"
            rows="2"
            placeholder="댓글을 입력하세요"
            required
          ></textarea>
          <div class="right">
            <button type="submit" class="btn primary-btn">댓글 작성</button>
          </div>
        </form>
      </section>
    </div>
  </div>

</main>

<!-- 모듈 JS -->
<script type="module" src="app.js"></script>
</body>
</html>
